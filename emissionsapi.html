

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Python API &mdash; Emissions API  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Database" href="database.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Emissions API
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="development.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="database.html">Database</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Python API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-emissionsapi.config">emissionsapi.config module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-emissionsapi.country_bounding_boxes">emissionsapi.country_bounding_boxes module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-emissionsapi.db">emissionsapi.db module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-emissionsapi.download">emissionsapi.download module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-emissionsapi.preprocess">emissionsapi.preprocess module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-emissionsapi.utils">emissionsapi.utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-emissionsapi.web">emissionsapi.web module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-emissionsapi">Module contents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#emissions-api">Emissions API</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Emissions API</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Python API</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/emissionsapi.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="python-api">
<h1>Python API<a class="headerlink" href="#python-api" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-emissionsapi.config">
<span id="emissionsapi-config-module"></span><h2>emissionsapi.config module<a class="headerlink" href="#module-emissionsapi.config" title="Permalink to this headline">¶</a></h2>
<p>Load and handle Emissions API configuration.</p>
<dl class="function">
<dt id="emissionsapi.config.config">
<code class="sig-prename descclassname">emissionsapi.config.</code><code class="sig-name descname">config</code><span class="sig-paren">(</span><em class="sig-param">*args</em><span class="sig-paren">)</span><a class="headerlink" href="#emissionsapi.config.config" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a specific configuration value or the whole configuration, loading
the configuration file if it was not before.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>key</strong> (<em>string</em>) – optional configuration key to return</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dictionary containing the configuration or configuration value</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="emissionsapi.config.configuration_file">
<code class="sig-prename descclassname">emissionsapi.config.</code><code class="sig-name descname">configuration_file</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#emissionsapi.config.configuration_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the best match for the configuration file.  The configuration file
locations taken into consideration are (in this particular order):</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">./emissionsapi.yml</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">~/emissionsapi.yml</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">/etc/emissionsapi.yml</span></code></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>configuration file name or None</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="emissionsapi.config.update_configuration">
<code class="sig-prename descclassname">emissionsapi.config.</code><code class="sig-name descname">update_configuration</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#emissionsapi.config.update_configuration" title="Permalink to this definition">¶</a></dt>
<dd><p>Update configuration.</p>
</dd></dl>

</div>
<div class="section" id="module-emissionsapi.country_bounding_boxes">
<span id="emissionsapi-country-bounding-boxes-module"></span><h2>emissionsapi.country_bounding_boxes module<a class="headerlink" href="#module-emissionsapi.country_bounding_boxes" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-emissionsapi.db">
<span id="emissionsapi-db-module"></span><h2>emissionsapi.db module<a class="headerlink" href="#module-emissionsapi.db" title="Permalink to this headline">¶</a></h2>
<p>Database layer for the Emmission API.</p>
<dl class="class">
<dt id="emissionsapi.db.AlembicVersion">
<em class="property">class </em><code class="sig-prename descclassname">emissionsapi.db.</code><code class="sig-name descname">AlembicVersion</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#emissionsapi.db.AlembicVersion" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.ext.declarative.declarative_base</span></code></p>
<dl class="attribute">
<dt id="emissionsapi.db.AlembicVersion.version_num">
<code class="sig-name descname">version_num</code><a class="headerlink" href="#emissionsapi.db.AlembicVersion.version_num" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="emissionsapi.db.Cache">
<em class="property">class </em><code class="sig-prename descclassname">emissionsapi.db.</code><code class="sig-name descname">Cache</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#emissionsapi.db.Cache" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.ext.declarative.declarative_base</span></code></p>
<p>ORM object for the request cache</p>
<dl class="attribute">
<dt id="emissionsapi.db.Cache.begin">
<code class="sig-name descname">begin</code><a class="headerlink" href="#emissionsapi.db.Cache.begin" title="Permalink to this definition">¶</a></dt>
<dd><p>Begin of the time interval involved in this request (used for
efficiently invalidating caches)</p>
</dd></dl>

<dl class="attribute">
<dt id="emissionsapi.db.Cache.end">
<code class="sig-name descname">end</code><a class="headerlink" href="#emissionsapi.db.Cache.end" title="Permalink to this definition">¶</a></dt>
<dd><p>End of the time interval involved in this request (used for efficiently
invalidating caches)</p>
</dd></dl>

<dl class="method">
<dt id="emissionsapi.db.Cache.invalidate">
<em class="property">classmethod </em><code class="sig-name descname">invalidate</code><span class="sig-paren">(</span><em class="sig-param">session</em>, <em class="sig-param">earliest</em>, <em class="sig-param">latest</em><span class="sig-paren">)</span><a class="headerlink" href="#emissionsapi.db.Cache.invalidate" title="Permalink to this definition">¶</a></dt>
<dd><p>Invalidates/deletes all cached responses in the given interval to
ensure these data is generated anew. This is meant to be run when the
underlying data for this interval changes, for instance since new data
has been imported.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>session</strong> (<em>sqlalchemy.orm.session.Session</em>) – SQLAlchemy Session</p></li>
<li><p><strong>earliest</strong> (<em>datetime.datetime</em>) – Earliest time of the interval to invalidate</p></li>
<li><p><strong>latest</strong> (<em>datetime.datetime</em>) – Latest time of the interval to invalidate</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="emissionsapi.db.Cache.request">
<code class="sig-name descname">request</code><a class="headerlink" href="#emissionsapi.db.Cache.request" title="Permalink to this definition">¶</a></dt>
<dd><p>Primary key identifying the request</p>
</dd></dl>

<dl class="attribute">
<dt id="emissionsapi.db.Cache.response">
<code class="sig-name descname">response</code><a class="headerlink" href="#emissionsapi.db.Cache.response" title="Permalink to this definition">¶</a></dt>
<dd><p>Cached response</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="emissionsapi.db.File">
<em class="property">class </em><code class="sig-prename descclassname">emissionsapi.db.</code><code class="sig-name descname">File</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#emissionsapi.db.File" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.ext.declarative.declarative_base</span></code></p>
<p>ORM object for the nc files.</p>
<dl class="attribute">
<dt id="emissionsapi.db.File.filename">
<code class="sig-name descname">filename</code><a class="headerlink" href="#emissionsapi.db.File.filename" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of processed data file</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="emissionsapi.db.filter_query">
<code class="sig-prename descclassname">emissionsapi.db.</code><code class="sig-name descname">filter_query</code><span class="sig-paren">(</span><em class="sig-param">query</em>, <em class="sig-param">wkt=None</em>, <em class="sig-param">distance=None</em>, <em class="sig-param">begin=None</em>, <em class="sig-param">end=None</em><span class="sig-paren">)</span><a class="headerlink" href="#emissionsapi.db.filter_query" title="Permalink to this definition">¶</a></dt>
<dd><p>Filter query by time and location.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query</strong> (<em>sqlalchemy.orm.Query</em>) – SQLAlchemy Query</p></li>
<li><p><strong>wkt</strong> (<em>geoalchemy2.WKTElement</em><em>, </em><em>optional</em>) – WKT Element specifying an area in which to search for points,
defaults to None.</p></li>
<li><p><strong>distance</strong> (<em>float</em><em>, </em><em>optional</em>) – Distance as defined in PostGIS’ <a class="reference external" href="https://postgis.net/docs/ST_DWithin.html">ST_DWithin</a> function.</p></li>
<li><p><strong>begin</strong> (<em>datetime.datetime</em><em>, </em><em>optional</em>) – Get only points after this timestamp, defaults to None</p></li>
<li><p><strong>end</strong> (<em>datetime.datetime</em><em>, </em><em>optional</em>) – Get only points before this timestamp, defaults to None</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>SQLAlchemy Query filtered by time and location.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>sqlalchemy.orm.query.Query</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="emissionsapi.db.get_averages">
<code class="sig-prename descclassname">emissionsapi.db.</code><code class="sig-name descname">get_averages</code><span class="sig-paren">(</span><em class="sig-param">session</em><span class="sig-paren">)</span><a class="headerlink" href="#emissionsapi.db.get_averages" title="Permalink to this definition">¶</a></dt>
<dd><p>Get daily averages of all points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>session</strong> (<em>sqlalchemy.orm.session.Session</em>) – SQLAlchemy Session</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>SQLAlchemy Query with tuple of the daily carbon monoxide average,
the maximal timestamp the minimal timestamp and the timestamp
truncated by day.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>sqlalchemy.orm.query.Query</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="emissionsapi.db.get_points">
<code class="sig-prename descclassname">emissionsapi.db.</code><code class="sig-name descname">get_points</code><span class="sig-paren">(</span><em class="sig-param">session</em><span class="sig-paren">)</span><a class="headerlink" href="#emissionsapi.db.get_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Get all points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>session</strong> (<em>sqlalchemy.orm.session.Session</em>) – SQLAlchemy Session</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>SQLAlchemy Query returning tuples of value, timestamp, longitude,
and latitude.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>sqlalchemy.orm.query.Query</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="emissionsapi.db.get_session">
<code class="sig-prename descclassname">emissionsapi.db.</code><code class="sig-name descname">get_session</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#emissionsapi.db.get_session" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a new session.</p>
<p>Lazy load the database connection and create the tables.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>sqlalchemy.orm.session.Session – SQLAlchemy Session object</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="emissionsapi.db.get_statistics">
<code class="sig-prename descclassname">emissionsapi.db.</code><code class="sig-name descname">get_statistics</code><span class="sig-paren">(</span><em class="sig-param">session</em>, <em class="sig-param">interval_length='day'</em><span class="sig-paren">)</span><a class="headerlink" href="#emissionsapi.db.get_statistics" title="Permalink to this definition">¶</a></dt>
<dd><p>Get statistical data like amount, average, min, or max values for a
specified time interval. Optionally, time and location filters can be
applied.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>session</strong> (<em>sqlalchemy.orm.session.Session</em>) – SQLAlchemy Session</p></li>
<li><p><strong>interval_length</strong> (<em>str</em>) – Length of the time interval for which data is being
aggregated as accepted by PostgreSQL’s <a class="reference external" href="https://postgresql.org/docs/9.1/functions-datetime.html">date_trunc</a>
function like <code class="docutils literal notranslate"><span class="pre">day</span></code> or <code class="docutils literal notranslate"><span class="pre">week</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>SQLAlchemy Query requesting the following statistical values for
the specified time interval:</p>
<ul class="simple">
<li><p>number of considered measurements</p></li>
<li><p>average carbon monoxide value</p></li>
<li><p>minimum carbon monoxide value</p></li>
<li><p>maximum carbon monoxide value</p></li>
<li><p>time of the first measurement</p></li>
<li><p>time of the last measurement</p></li>
<li><p>start of the interval</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>sqlalchemy.orm.query.Query</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="emissionsapi.db.insert_dataset">
<code class="sig-prename descclassname">emissionsapi.db.</code><code class="sig-name descname">insert_dataset</code><span class="sig-paren">(</span><em class="sig-param">session</em>, <em class="sig-param">data</em>, <em class="sig-param">tbl=sqlalchemy.Table</em><span class="sig-paren">)</span><a class="headerlink" href="#emissionsapi.db.insert_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Batch insert data into the database using PostGIS specific functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>session</strong> (<em>sqlalchemy.orm.session.Session</em>) – SQLAlchemy Session</p></li>
<li><p><strong>data</strong> (<em>pandas.core.frame.DataFrame</em>) – DataFrame containing value, timestamp, longitude and latitude</p></li>
<li><p><strong>tbl</strong> (<em>sqlalchemy.ext.declarative.api.DeclarativeMeta</em>) – Base class representing the database table for the data</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="emissionsapi.db.limit_offset_query">
<code class="sig-prename descclassname">emissionsapi.db.</code><code class="sig-name descname">limit_offset_query</code><span class="sig-paren">(</span><em class="sig-param">query</em>, <em class="sig-param">limit=None</em>, <em class="sig-param">offset=None</em><span class="sig-paren">)</span><a class="headerlink" href="#emissionsapi.db.limit_offset_query" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply limit and offset to the query.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query</strong> (<em>sqlalchemy.orm.Query</em>) – SQLAlchemy Query</p></li>
<li><p><strong>limit</strong> (<em>int</em><em>, </em><em>optional</em>) – Limit number of Items returned, defaults to None</p></li>
<li><p><strong>offset</strong> (<em>int</em><em>, </em><em>optional</em>) – Specify the offset of the first hit to return,
defaults to None</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>SQLAlchemy Query with limit and offset applied.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>sqlalchemy.orm.query.Query</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="emissionsapi.db.with_session">
<code class="sig-prename descclassname">emissionsapi.db.</code><code class="sig-name descname">with_session</code><span class="sig-paren">(</span><em class="sig-param">f</em><span class="sig-paren">)</span><a class="headerlink" href="#emissionsapi.db.with_session" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper for f to make a SQLAlchemy session present within the function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>f</strong> (<em>Function</em>) – Function to call</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>e</strong> – Possible exception of f</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Result of f</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-emissionsapi.download">
<span id="emissionsapi-download-module"></span><h2>emissionsapi.download module<a class="headerlink" href="#module-emissionsapi.download" title="Permalink to this headline">¶</a></h2>
<p>Module to filter and download the data from the ESA and store it locally.</p>
<dl class="function">
<dt id="emissionsapi.download.download">
<code class="sig-prename descclassname">emissionsapi.download.</code><code class="sig-name descname">download</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#emissionsapi.download.download" title="Permalink to this definition">¶</a></dt>
<dd><p>Download data files from ESA and store them in the configured storage
directory.</p>
</dd></dl>

<dl class="function">
<dt id="emissionsapi.download.filtered_download">
<code class="sig-prename descclassname">emissionsapi.download.</code><code class="sig-name descname">filtered_download</code><span class="sig-paren">(</span><em class="sig-param">polygon=None</em>, <em class="sig-param">begin_ts=None</em>, <em class="sig-param">end_ts=None</em><span class="sig-paren">)</span><a class="headerlink" href="#emissionsapi.download.filtered_download" title="Permalink to this definition">¶</a></dt>
<dd><p>Download Sentinel 5 data from the ESA and store them in the data
directory.
The downloaded files are optionally filtered by location, start and end
time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>polygon</strong> (<em>str</em><em>, </em><em>optional</em>) – WKT polygon specifying an area the data should intersect,
defaults to None</p></li>
<li><p><strong>begin_ts</strong> (<em>str</em><em>, </em><em>optional</em>) – ISO-8601 timestamp specifying the earliest sensing date,
defaults to None</p></li>
<li><p><strong>end_ts</strong> (<em>str</em><em>, </em><em>optional</em>) – ISO-8601 timestamp specifying the latest sensing date,
defaults to None</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-emissionsapi.preprocess">
<span id="emissionsapi-preprocess-module"></span><h2>emissionsapi.preprocess module<a class="headerlink" href="#module-emissionsapi.preprocess" title="Permalink to this headline">¶</a></h2>
<p>Preprocess the locally stored data and store them in the database.</p>
<dl class="function">
<dt id="emissionsapi.preprocess.list_ncfiles">
<code class="sig-prename descclassname">emissionsapi.preprocess.</code><code class="sig-name descname">list_ncfiles</code><span class="sig-paren">(</span><em class="sig-param">session</em><span class="sig-paren">)</span><a class="headerlink" href="#emissionsapi.preprocess.list_ncfiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Generator yielding all nc files in download path.</p>
</dd></dl>

<dl class="function">
<dt id="emissionsapi.preprocess.main">
<code class="sig-prename descclassname">emissionsapi.preprocess.</code><code class="sig-name descname">main</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#emissionsapi.preprocess.main" title="Permalink to this definition">¶</a></dt>
<dd><p>Entrypoint for running this as a module or from the binary.
Triggers the preprocessing of the data.</p>
</dd></dl>

<dl class="function">
<dt id="emissionsapi.preprocess.write_to_database">
<code class="sig-prename descclassname">emissionsapi.preprocess.</code><code class="sig-name descname">write_to_database</code><span class="sig-paren">(</span><em class="sig-param">session</em>, <em class="sig-param">data</em>, <em class="sig-param">filepath</em><span class="sig-paren">)</span><a class="headerlink" href="#emissionsapi.preprocess.write_to_database" title="Permalink to this definition">¶</a></dt>
<dd><p>Write data to the PostGIS database</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>session</strong> (<em>sqlalchemy.orm.session.Session</em>) – SQLAlchemy Session</p></li>
<li><p><strong>data</strong> (<em>pandas.core.frame.DataFrame</em>) – Data to add to the database</p></li>
<li><p><strong>filepath</strong> (<em>str</em>) – Path to the file being imported</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-emissionsapi.utils">
<span id="emissionsapi-utils-module"></span><h2>emissionsapi.utils module<a class="headerlink" href="#module-emissionsapi.utils" title="Permalink to this headline">¶</a></h2>
<dl class="exception">
<dt id="emissionsapi.utils.RESTParamError">
<em class="property">exception </em><code class="sig-prename descclassname">emissionsapi.utils.</code><code class="sig-name descname">RESTParamError</code><a class="headerlink" href="#emissionsapi.utils.RESTParamError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ValueError</span></code></p>
<p>User-specific exception, used in <a class="reference internal" href="#emissionsapi.utils.polygon_to_wkt" title="emissionsapi.utils.polygon_to_wkt"><code class="xref py py-func docutils literal notranslate"><span class="pre">polygon_to_wkt()</span></code></a>.</p>
</dd></dl>

<dl class="function">
<dt id="emissionsapi.utils.bounding_box_to_wkt">
<code class="sig-prename descclassname">emissionsapi.utils.</code><code class="sig-name descname">bounding_box_to_wkt</code><span class="sig-paren">(</span><em class="sig-param">lon1</em>, <em class="sig-param">lat1</em>, <em class="sig-param">lon2</em>, <em class="sig-param">lat2</em><span class="sig-paren">)</span><a class="headerlink" href="#emissionsapi.utils.bounding_box_to_wkt" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a bounding box specified by its top-left and bottom-right
coordinates to a wkt string defining a polygon.</p>
</dd></dl>

<dl class="function">
<dt id="emissionsapi.utils.polygon_to_wkt">
<code class="sig-prename descclassname">emissionsapi.utils.</code><code class="sig-name descname">polygon_to_wkt</code><span class="sig-paren">(</span><em class="sig-param">polygon</em><span class="sig-paren">)</span><a class="headerlink" href="#emissionsapi.utils.polygon_to_wkt" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a list of points to a WKT string defining a polygon.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>polygon</strong> (<em>list</em>) – List of values with every pair of values representing a
consecutive vertex of the polygon.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>WKT defining the polygon.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-emissionsapi.web">
<span id="emissionsapi-web-module"></span><h2>emissionsapi.web module<a class="headerlink" href="#module-emissionsapi.web" title="Permalink to this headline">¶</a></h2>
<p>Web application to deliver the data stored in the database via an API to
the users.</p>
<dl class="function">
<dt id="emissionsapi.web.cache_with_session">
<code class="sig-prename descclassname">emissionsapi.web.</code><code class="sig-name descname">cache_with_session</code><span class="sig-paren">(</span><em class="sig-param">function</em><span class="sig-paren">)</span><a class="headerlink" href="#emissionsapi.web.cache_with_session" title="Permalink to this definition">¶</a></dt>
<dd><p>Function wrapper caching responses based on their request parameters in
the PostgreSQL database.</p>
<p>The established database session is passed to the wrapped function as first
argument much like <a class="reference internal" href="#emissionsapi.db.with_session" title="emissionsapi.db.with_session"><code class="xref py py-func docutils literal notranslate"><span class="pre">with_session()</span></code></a> in case no cached
value for this request is present yet.</p>
<p>Argument names for beginning and end of a time frame affecting the cache
are automatically assumed to be named <code class="docutils literal notranslate"><span class="pre">begin</span></code> and <code class="docutils literal notranslate"><span class="pre">end</span></code>.  These are
stored alongside the cached data to determine if the cached values needs to
be purged when importing new data.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Function wrapper</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>func</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="emissionsapi.web.entrypoint">
<code class="sig-prename descclassname">emissionsapi.web.</code><code class="sig-name descname">entrypoint</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#emissionsapi.web.entrypoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Entrypoint for running this as a module or from the binary.
It starts the Connexion Debug Server. It is not meant to be used for
production, but only during the development.</p>
</dd></dl>

<dl class="function">
<dt id="emissionsapi.web.get_average">
<code class="sig-prename descclassname">emissionsapi.web.</code><code class="sig-name descname">get_average</code><span class="sig-paren">(</span><em class="sig-param">session</em>, <em class="sig-param">wkt=None</em>, <em class="sig-param">distance=None</em>, <em class="sig-param">begin=None</em>, <em class="sig-param">end=None</em>, <em class="sig-param">limit=None</em>, <em class="sig-param">offset=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#emissionsapi.web.get_average" title="Permalink to this definition">¶</a></dt>
<dd><p>Get daily average for a specified area filtered by time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>session</strong> (<em>sqlalchemy.orm.session.Session</em>) – SQLAlchemy session</p></li>
<li><p><strong>wkt</strong> (<em>string</em><em>, </em><em>optional</em>) – Well-known text representation of geometry, defaults to None.</p></li>
<li><p><strong>distance</strong> (<em>float</em><em>, </em><em>optional</em>) – Distance as defined in PostGIS’ <a class="reference external" href="https://postgis.net/docs/ST_DWithin.html">ST_DWithin</a> function.</p></li>
<li><p><strong>begin</strong> (<em>datetime.datetime</em>) – Filter out points before this date</p></li>
<li><p><strong>end</strong> (<em>datetime.datetime</em>) – filter out points after this date</p></li>
<li><p><strong>limit</strong> (<em>int</em>) – Limit number of returned items</p></li>
<li><p><strong>offset</strong> (<em>int</em>) – Specify the offset of the first item to return</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of calculated averages</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="emissionsapi.web.get_data">
<code class="sig-prename descclassname">emissionsapi.web.</code><code class="sig-name descname">get_data</code><span class="sig-paren">(</span><em class="sig-param">session</em>, <em class="sig-param">wkt=None</em>, <em class="sig-param">distance=None</em>, <em class="sig-param">begin=None</em>, <em class="sig-param">end=None</em>, <em class="sig-param">limit=None</em>, <em class="sig-param">offset=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#emissionsapi.web.get_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Get data in GeoJSON format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>session</strong> (<em>sqlalchemy.orm.session.Session</em>) – SQLAlchemy session</p></li>
<li><p><strong>wkt</strong> (<em>string</em><em>, </em><em>optional</em>) – Well-known text representation of geometry, defaults to None.</p></li>
<li><p><strong>distance</strong> (<em>float</em><em>, </em><em>optional</em>) – Distance as defined in PostGIS’ <a class="reference external" href="https://postgis.net/docs/ST_DWithin.html">ST_DWithin</a> function.</p></li>
<li><p><strong>end</strong> (<em>datetime.datetime</em>) – filter out points after this date</p></li>
<li><p><strong>limit</strong> (<em>int</em>) – Limit number of returned items</p></li>
<li><p><strong>offset</strong> (<em>int</em>) – Specify the offset of the first item to return</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Feature Collection with requested Points</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>geojson.FeatureCollection</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="emissionsapi.web.get_statistics">
<code class="sig-prename descclassname">emissionsapi.web.</code><code class="sig-name descname">get_statistics</code><span class="sig-paren">(</span><em class="sig-param">session</em>, <em class="sig-param">interval='day'</em>, <em class="sig-param">wkt=None</em>, <em class="sig-param">distance=None</em>, <em class="sig-param">begin=None</em>, <em class="sig-param">end=None</em>, <em class="sig-param">limit=None</em>, <em class="sig-param">offset=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#emissionsapi.web.get_statistics" title="Permalink to this definition">¶</a></dt>
<dd><p>Get statistical data like amount, average, min, or max values for a
specified time interval. Optionally, time and location filters can be
applied.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>session</strong> (<em>sqlalchemy.orm.session.Session</em>) – SQLAlchemy session</p></li>
<li><p><strong>interval</strong> (<em>str</em>) – Length of the time interval for which data is being
aggregated as accepted by PostgreSQL’s <a class="reference external" href="https://postgresql.org/docs/9.1/functions-datetime.html">date_trunc</a>
function like <code class="docutils literal notranslate"><span class="pre">day</span></code> or <code class="docutils literal notranslate"><span class="pre">week</span></code>.</p></li>
<li><p><strong>wkt</strong> (<em>string</em><em>, </em><em>optional</em>) – Well-known text representation of geometry, defaults to None.</p></li>
<li><p><strong>distance</strong> (<em>float</em><em>, </em><em>optional</em>) – Distance as defined in PostGIS’ <a class="reference external" href="https://postgis.net/docs/ST_DWithin.html">ST_DWithin</a> function.</p></li>
<li><p><strong>begin</strong> (<em>datetime.datetime</em>) – Filter out points before this date</p></li>
<li><p><strong>end</strong> (<em>datetime.datetime</em>) – filter out points after this date</p></li>
<li><p><strong>limit</strong> (<em>int</em>) – Limit number of returned items</p></li>
<li><p><strong>offset</strong> (<em>int</em>) – Specify the offset of the first item to return</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of statistical values</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="emissionsapi.web.home">
<code class="sig-prename descclassname">emissionsapi.web.</code><code class="sig-name descname">home</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#emissionsapi.web.home" title="Permalink to this definition">¶</a></dt>
<dd><p>Redirect / to the swagger ui</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Redirect response</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>werkzeug.wrappers.response.Response</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="emissionsapi.web.parse_date">
<code class="sig-prename descclassname">emissionsapi.web.</code><code class="sig-name descname">parse_date</code><span class="sig-paren">(</span><em class="sig-param">*keys</em><span class="sig-paren">)</span><a class="headerlink" href="#emissionsapi.web.parse_date" title="Permalink to this definition">¶</a></dt>
<dd><p>Function wrapper replacing string date arguments with
datetime.datetime</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>keys</strong> (<em>list</em>) – keys to be parsed and replaced</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>wrapper function</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>func</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="emissionsapi.web.parse_wkt">
<code class="sig-prename descclassname">emissionsapi.web.</code><code class="sig-name descname">parse_wkt</code><span class="sig-paren">(</span><em class="sig-param">f</em><span class="sig-paren">)</span><a class="headerlink" href="#emissionsapi.web.parse_wkt" title="Permalink to this definition">¶</a></dt>
<dd><p>Function wrapper replacing ‘geoframe’, ‘country’ and ‘polygon’ with a
WKT polygon.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>f</strong> (<em>Function</em>) – Function to call</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>e</strong> – Possible exception of f</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Result of f</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-emissionsapi">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-emissionsapi" title="Permalink to this headline">¶</a></h2>
<div class="section" id="emissions-api">
<h3>Emissions API<a class="headerlink" href="#emissions-api" title="Permalink to this headline">¶</a></h3>
<p>Emissions API’s mission is to provide easy access to European Space Agency’s
Sentinel-5P satellite data without the need of being an expert in satellite
data analysis and without having to process terabytes of data.</p>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>2019, The Emissions API Developers</p>
</dd>
<dt class="field-even">url</dt>
<dd class="field-even"><p><a class="reference external" href="https://emissions-api.org">https://emissions-api.org</a></p>
</dd>
<dt class="field-odd">license</dt>
<dd class="field-odd"><p>MIT</p>
</dd>
</dl>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="database.html" class="btn btn-neutral float-left" title="Database" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019 The Emissions API Developers (https://emissions-api.org)

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>