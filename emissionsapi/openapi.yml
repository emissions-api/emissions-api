openapi: 3.0.0
info:
  title: Emissions API
  description: >-
      Emissions APIâ€™s mission is to provide easy access to this data without
      the need of being an expert in satellite data analysis and without having
      to process terabytes of data.
  version: "0.1"
  contact:
    name: The Emissions API Developers
    url: https://emissions-api.org
    email: info@emissions-api.org
externalDocs:
  description: Source code documentation
  url: https://docs.emissions-api.org
paths:
  /api/v1/geo.json/:
    get:
      operationId: emissionsapi.web.get_data
      description: |
          Get all points in [GeoJSON](https://geojson.org/) format.

          The parameters `geoframe`, `country` and `polygon` overwrite each other so that only one will be used even if multiple parameters are provided.
          The priority of the parameter is:
            1. geoframe
            2. country
            3. polygon
      parameters:
        - $ref: '#/components/parameters/geoframe'
        - $ref: '#/components/parameters/country'
        - $ref: '#/components/parameters/polygon'
        - $ref: '#/components/parameters/begin'
        - $ref: '#/components/parameters/end'
        - $ref: '#/components/parameters/limit'
        - $ref: '#/components/parameters/offset'
      responses:
        200:
          description: The response contains all known points located within the specified rectangle contained in a GeoJSON feature collection.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Feature Collection'
        400:
          description: Parameter error
  /api/v1/daily.json:
    get:
      operationId: emissionsapi.web.get_daily
      description: |
          Get daily values for a specified area filtered by time.

          The parameters `geoframe`, `country` and `polygon` overwrite each other so that only one will be used even if multiple parameters are provided.
          The priority of the parameter is:
            1. geoframe
            2. country
            3. polygon
      parameters:
        - $ref: '#/components/parameters/geoframe'
        - $ref: '#/components/parameters/country'
        - $ref: '#/components/parameters/polygon'
        - $ref: '#/components/parameters/begin'
        - $ref: '#/components/parameters/end'
        - $ref: '#/components/parameters/limit'
        - $ref: '#/components/parameters/offset'
      responses:
        200:
          description: Array of daily carbon monoxide values.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Daily'
        400:
          description: Parameter error

components:
  parameters:
    limit:
      in: query
      name: limit
      description: Limit number of items returned.
      schema:
        type: integer
        minimum: 0
      example: 100
    offset:
      in: query
      name: offset
      description: Specify the offset of the first hit to return.
      schema:
        type: integer
        minimum: 0
      example: 100
    geoframe:
      in: query
      name: geoframe
      schema:
        type: array
        items:
          type: number
        maxItems: 4
        minItems: 4
      description: |
          `geoframe` will let you define your own rectangle from which the data is chosen.
          The Parameter must be in the form lo1,la1,lo2,la2 and represent the upper left and lower right corners of a rectangle.
      example: [15, 45, 20, 40]
    country:
      in: query
      name: country
      schema:
        type: string
      description: "`country` will use a preselected rectangle containing the specified country. Like 'DE'."
      example: DE
    polygon:
      in: query
      name: polygon
      schema:
        type: array
        items:
          type: number
        minItems: 3
      description: |
        The parameter must be in the form lo1,la1,lo2,la2,... and every pair of values represent a vertex of longitude and latitude.
        The polygon is then defined as the line segments of the consecutive vertices.

        If the first and last vertices do not match, the first vertex is automatically appended to close the polygon.
      example: [30, 10, 40, 40, 20, 40, 10, 20, 30, 10]
    begin:
      in: query
      name: begin
      schema:
        type: string
      description: "`begin` filter out points before this date. The date itself is included."
      example: 2019-02-10
    end:
      in: query
      name: end
      schema:
        type: string
      description: "`end` filter out points before this date. The date itself is not included."
      example: 2019-02-11


  schemas:
    Feature Collection:
      description: Points as GeoJSON Feature Collection
      type: object
      properties:
        features:
          type: array
          items:
            type: object
            properties:
              type:  # This is the name of the key
                type: string
                example: FeatureCollection
              properties:  # This is the name of the key
                type: object
                properties:
                  carbonmonixide:
                    type: number
                    example: 0.0273975990712643
                  timestamp:
                    type: string
                    example: "2019-09-21T12:26:28.762000Z"
              geometry:
                type: object
                properties:
                  coordinates:
                    type: array
                    maxItems: 2
                    minItems: 2
                    items:
                      type: number
                    example: [15.096772, 44.516739]
                  type:  # This is the name of the key
                    type: string
                    example: "Point"
    Daily:
      type: array
      description: Array of daily carbon monoxide values.
      items:
        type: object
        properties:
          value:
            type: object
            properties:
              count:
                type: number
                example: 100
              average:
                type: number
                example: 0.0312481193586528
              standard deviation:
                type: number
                example: 0.0123
              min:
                type: number
                example: 0.02
              max:
                type: number
                example: 0.04
          time:
            type: object
            properties:
              start:
                type: date-time
                example: 2019-02-10T13:05:08.812000Z
              end:
                type: date-time
                example: 2019-02-10T13:03:40.254000Z
              day:
                type: date
                example: 2019-02-10
